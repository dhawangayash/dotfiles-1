;;----------------------------------------------------------------------------
;; ~/.stumpwmrc
;;----------------------------------------------------------------------------
;; author: milomouse <vincent[at]fea.st>
;; update: 2010-10-31 22:15:20
;;----------------------------------------------------------------------------
;; versions used atoc:
;; |  clisp-new-clx     -> 2.48-2
;; |  cl-asdf           -> 20101020-1
;; |  cl-ppcre          -> 2.0.3-1
;; |  stumpwm-git       -> 20101027-1
;; |  surfraw-git       -> 20100929-1
;;-TODO:----------------------------------------------------------------------
;; >>--: create a 'dedicate' and 'catchall' hook for changing focus color
;; >>>-: create a 'dedicate' and 'catchall' window-rule (remember * *)
;; >---: have mifo(mplayer-daemon) prompts use filename completion
;; >>>>: command for dedicating current win/frame as the Master win/frame
;; >>>>! command for swapping current window with the Master win/frame
;; >---: better resize; if neighbor {above} then -ARG else +ARG, etc
;; >>>-: show frame-indicator for 'resize' only if no window in frame
;; >>--: command-mode for mifo video:seek to eliminate extra key-presses
;; >---: have my 'undo' use group and check current group for undos first.
;;----------------------------------------------------------------------------
;; file/s: *data-dir*/{commands,functions,hooks,key-maps,macros}.lisp
;;-NOTE:----------------------------------------------------------------------
;; for MPlayer, use: mplayer -nokeepaspect {-fstype netwm}
;;----------------------------------------------------------------------------


(in-package :stumpwm)
(clear-window-placement-rules)
(setf *data-dir* "~/.config/stumpwm/storage/")
(defcommand run-shell-command (cmd &optional collect-output-p)
  ((:shell "execute: ")) (if collect-output-p
    (run-prog-collect-output *shell-program* "-c" cmd)
    (run-prog *shell-program* :args (list "-c" cmd) :wait nil)))
(setf *shell-program* "/bin/zsh")
(defcommand-alias exec run-shell-command)

;; function pre-variables
(defvar *surfraw-bookmark-file* (data-dir-file "bookmarks" "txt"))
(defvar *background-image-path* "~/foto/wall/")

;; borders and gravity
(setf *resize-hides-windows* T
      *normal-border-width* 2
      *maxsize-border-width* 2
      *transient-border-width* 2
      *float-window-border* 1
      *float-window-title-height* 1
      *msg-border-width* 1
      *mouse-focus-policy* :click
      *window-border-style* :thin
      *message-window-gravity* :top-right
      *input-window-gravity* :top-right
      *timeout-wait* 6)

;; fonts/colors
(set-font "-*-fixed-medium-r-normal-*-10-*-*-*-*-*-*-*")
(set-fg-color        "#a19ea8")
(set-bg-color        "grey15")
(set-border-color    "grey45")
;(set-focus-color     "#d74b73")
(set-focus-color     "#746890")
(set-unfocus-color   "#1c1c1c")
(set-win-bg-color    "#090909")
(setf *colors* (list "#1c1c1c"   ;; 0 - black
                     "#d74b73"   ;; 1 - red
                     "#799c99"   ;; 2 - green
                     "#c8bc45"   ;; 3 - yellow
                     "#6c7373"   ;; 4 - blue
                     "#a488d9"   ;; 5 - magenta
                     "#508686"   ;; 6 - cyan
                     "#8d8d8d"   ;; 7 - white
                     "#585872"   ;; 8 - (user) faint magenta
                     "#57718b")) ;; 9 - (user) bright blue
(defun fmt-group-status (group)
  (let ((screen (group-screen group)))
    (cond ((eq group (screen-current-group screen))
           #\*)
          ((and (typep (second (screen-groups screen)) 'group)
                (eq group (second (screen-groups screen))))
           #\+)
          (t #\-))))
(update-color-map (current-screen))

;; text formatting (no mode-line)
(setf *time-day-names* #("Mon" "Tue" "Wed" "Thu" "Fri" "Sat" "Sun")
      *time-format-string-default* "^B^2*%T^9* %Y-%m-%d^**/^8*%A^**^b"
      *screen-mode-line-format* nil
      *startup-message* "^B^1*together we ate the king^**^b:^B^5*and laughed ourselves to death^**^b"
      *group-format*    "^B^8*%t^7*%s^07|^**^b"
      *window-format*   "^B^27%s^1*%m^0*%16t^**^b"
      *debug-level* 10)

;; windows/frames
(setf *default-window-name* "null"
      *normal-gravity* :top-right
      *maxsize-gravity* :top-right
      *transient-gravity* :center
      *new-frame-action* :empty
      *min-frame-width* 100
      *min-frame-height* 50
      *resize-increment* 10
      *frame-number-map* "jkluio789")

;; mode-line/input
(setf *mode-line-background-color* "grey13"
      *mode-line-border-color* "grey25"
      *mode-line-foreground-color* "#a9a6af"
      *mode-line-border-width* 1
      *mode-line-pad-x* 1
      *mode-line-pad-y* 0
      *mode-line-timeout* 1
      *mode-line-position* :top
      *input-history-ignore-duplicates* 0)

;; load external settings' file/s
(loop for file in '("functions" "macros" "commands" "hooks" "key-maps")
      do (load (make-pathname :name file :type "lisp" :directory
      '(:relative ".config" "stumpwm"))))

(setf (group-name (first (screen-groups (current-screen)))) "1")
(make-groups-bg "2" "3" "4" "5" "6")
(restore-from-file (data-dir-file "screen_data_last"))
(restore-window-placement-rules (data-dir-file "placement_rules"))
;(display-random-bg)

