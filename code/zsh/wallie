#!/bin/zsh
#################################################
# author: milomouse <vincent[at]fea.st>         #
# detail: set a random wallpaper upon execution #
#################################################
# depend: find + grep + ${xsetcmd} +~ xdpyinfo  #
#################################################
unsetopt nomatch

#################################################
# NOTE: KEEP VARIABLES INSIDE BRACES: var=(arg) #
#################################################

# find proper dimensions (optional):
_xy=(${$(xdpyinfo|grep dimensions)[2]})

# image setter commands:
XSETCMD=(display)
XSETARG=(-window root -resize ${_xy}!)

# base directory for images:
FOTODIR=(${HOME}/foto/wall)

# allowed file types:
ALLOWED=(.png .jpg .jpeg .tiff .svg .bmp .gif)

############################################# {{{
# DO NOT EDIT UNLESS YOU KNOW WHAT YOU'RE DOING #
#################################################

[[ -n ${DISPLAY} ]] && (
[[ -x $(which ${XSETCMD}) ]] && (

_alist=($(find ${FOTODIR} -type f\
  | grep -ie ${${(f)ALLOWED}// /\\|}))
_count=${${(fw)#_alist}// /_/}
until [[ ${__} -le ${_count} && ${__} -gt 0 ]] {
  __=${RANDOM[1,${_count}]}
  foto=${${_alist}[$__]} }

${XSETCMD} ${XSETARG} ${foto} ))

############################################# }}}
